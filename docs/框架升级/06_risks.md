# 风险提示

> 文档版本: 2026-01-23
> 模块: 风险管理

---

## 6.1 已知风险

### 策略风险

| 风险 | 描述 | 影响程度 |
|------|------|----------|
| **策略失效** | 市场环境变化导致因子失效 | 高 |
| **过度优化** | 权重调优导致过拟合 | 高 |
| **小样本偏差** | 样本量不足导致统计不可靠 | 中 |
| **市场状态误判** | Regime 判断滞后或错误 | 中 |
| **叙事污染** | 把 ERP/HSGT/博弈 proxy 当“确定性买卖按钮”，导致追涨杀跌 | 高 |
| **因子漂移** | 资金/宏观口径变化或市场结构变化，导致历史规律失效 | 中 |

### 技术风险

| 风险 | 描述 | 影响程度 |
|------|------|----------|
| **数据源不稳定** | AkShare/TuShare 限流或停服 | 高 |
| **数据质量问题** | 缺失、错误、延迟数据 | 中 |
| **代码bug** | 计算错误、逻辑漏洞 | 中 |
| **依赖版本** | 第三方库升级导致兼容问题 | 低 |
| **TuShare 依赖风险** | 积分/限流/接口变更；启用自定义 http_url 需自担风险 | 中 |

### 执行风险

| 风险 | 描述 | 影响程度 |
|------|------|----------|
| **滑点** | 实际成交价与预期偏离 | 中 |
| **流动性** | 无法按预期价格成交 | 中 |
| **执行延迟** | 人工执行错过最佳时机 | 中 |
| **涨跌停** | 无法买入/卖出 | 低 |
| **T+1 约束** | 用收盘信号却想当天买卖，执行口径错误 | 中 |
| **最低佣金** | 小额频繁交易被 5 元最低佣金磨死 | 中 |

### 黑天鹅风险

| 风险 | 描述 | 影响程度 |
|------|------|----------|
| **极端行情** | 熔断、连续跌停 | 极高 |
| **政策变化** | 交易规则突变 | 高 |
| **流动性危机** | 市场整体流动性枯竭 | 高 |

---

## 6.2 应对措施

### 策略风险应对

```
┌─────────────────────────────────────────────────────────────────────┐
│                        策略风险应对                                  │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  因子监控                                                            │
│  ├── IC/IR 定期计算（每周）                                          │
│  ├── 发现衰减（IC < 0.02 连续3周）→ 降权                             │
│  └── 严重衰减（IC < 0）→ 剔除                                        │
│                                                                     │
│  Walk-forward 验证                                                   │
│  ├── 训练窗口 252天 / 测试窗口 63天                                  │
│  ├── OOS/IS 比率监控                                                 │
│  └── OOS 显著下降 → 停止优化                                         │
│                                                                     │
│  多策略分散                                                          │
│  ├── 不依赖单一因子                                                  │
│  ├── BBB + 短线 + ETF轮动 组合                                       │
│  └── 单策略权重 < 40%                                                │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 技术风险应对

```python
# 数据源容错示例
def fetch_with_fallback(symbol: str) -> pd.DataFrame:
    """优先AkShare，挂了用缓存，再挂抛异常但不崩"""
    try:
        return fetch_akshare(symbol)
    except Exception:
        logger.warning(f"AkShare failed for {symbol}, trying cache")
        cached = load_cache(symbol)
        if cached is not None:
            return cached
        raise DataSourceError(f"No data available for {symbol}")
```

### 执行风险应对

| 风险 | 应对措施 |
|------|----------|
| 滑点 | 回测纳入 0.1% 滑点成本 |
| 流动性 | 过滤日均成交额 < 5000万的标的 |
| 执行延迟 | 限价单 + 有效期控制 |
| 涨跌停 | 剔除涨跌停标的，不追板 |

### 黑天鹅应对

```
账户级熔断机制:
├── 单日回撤 >= 5% → 今日不再交易
├── 单周回撤 >= 10% → 减仓50%
├── 总回撤 >= 20% → 全部清仓
└── 熔断后冷静期 5天
```

---

## 6.3 风控检查清单

### 每日检查

- [ ] 数据更新是否正常
- [ ] 持仓盈亏是否在预期范围
- [ ] 是否触发止损/止盈
- [ ] 异常波动标的是否需要人工干预

### 每周检查

- [ ] 因子 IC/IR 是否正常
- [ ] 策略信号质量
- [ ] 持仓集中度
- [ ] 账户回撤情况

### 每月检查

- [ ] 策略收益统计
- [ ] 因子有效性评估
- [ ] 参数敏感性分析
- [ ] 数据质量审计

### 每季度检查

- [ ] 全面策略复盘
- [ ] Walk-forward 重新验证
- [ ] 风控参数调整
- [ ] 市场环境评估

---

## 6.4 风险指标监控

### 关键指标

| 指标 | 计算方法 | 预警阈值 | 严重阈值 |
|------|----------|----------|----------|
| 最大回撤 | (峰值-谷值)/峰值 | > 10% | > 20% |
| 夏普比率 | (收益率-无风险)/波动率 | < 1.0 | < 0.5 |
| 卡玛比率 | 年化收益/最大回撤 | < 1.5 | < 1.0 |
| 胜率 | 盈利次数/总次数 | < 45% | < 40% |
| 盈亏比 | 平均盈利/平均亏损 | < 1.5 | < 1.0 |
| 单笔最大亏损 | 单次最大亏损/本金 | > 3% | > 5% |

### 监控面板

```
┌─────────────────────────────────────────────────────────────────────┐
│                        风险监控面板                                  │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  账户状态                                                            │
│  ├── 当前权益: ¥100,000                                             │
│  ├── 日回撤: -1.2% ✅                                               │
│  ├── 周回撤: -3.5% ✅                                               │
│  └── 总回撤: -8.2% ⚠️                                               │
│                                                                     │
│  因子健康度                                                          │
│  ├── ma_cross IC: 0.045 ✅                                          │
│  ├── momentum IC: 0.032 ✅                                          │
│  ├── rsi IC: 0.018 ⚠️ (连续2周下降)                                 │
│  └── volume_ratio IC: 0.028 ✅                                      │
│                                                                     │
│  策略状态                                                            │
│  ├── BBB: 运行中 | 胜率 52% ✅                                       │
│  ├── 短线: 运行中 | 胜率 48% ✅                                      │
│  └── 激进: 暂停 | 熊市环境                                           │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 6.5 应急预案

### 数据源故障

```
1. 切换备用数据源 (Sina/东方财富)
2. 使用本地缓存数据
3. 暂停自动扫描
4. 手动确认持仓状态
```

### 策略异常

```
1. 立即停止异常策略
2. 检查最近代码变更
3. 回滚到上一稳定版本
4. 人工审核持仓
```

### 极端行情

```
1. 触发账户熔断
2. 全部清仓或减仓
3. 进入冷静期 (5天)
4. 重新评估市场状态后恢复
```

---

## 相关文档

- [红线约束](./00_constraints.md) - 必须遵守的研究规范
- [策略增强模块](./04_strategy_modules.md) - 熔断模块详情
- [实施路线图](./05_roadmap.md) - 风控模块实施计划

---

**风险声明**: 本框架仅供研究学习，不构成投资建议。交易有风险，入市需谨慎。
